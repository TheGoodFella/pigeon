DROP DATABASE IF EXISTS PIGEON;
CREATE DATABASE PIGEON;
USE PIGEON;

/*TABLES*/
CREATE TABLE USERS(
ID_USER INTEGER NOT NULL AUTO_INCREMENT,
NAME VARCHAR(50) NOT NULL,
LASTNAME VARCHAR(50) NOT NULL,
USERNAME VARCHAR(20) NOT NULL,
PASSWORD VARCHAR(50) NOT NULL,
EMAIL VARCHAR 50 NOT NULL,
IMAGE VARCHAR(50) NOT NULL,
PRIMARY KEY(ID_USER)
);

CREATE TABLE CHANNELS(
ID_CHANNEL INTEGER NOT NULL AUTO_INCREMENT,
NAME VARCHAR(50) NOT NULL,
IMAGE VARCHAR(50) NOT NULL,
CREATION_DATE DATE NOT NULL,
PRIMARY KEY(ID_CHANNEL)
);

CREATE TABLE BELONGS_TO(
ID_CHANNEL INTEGER NOT NULL,
ID_USER INTEGER NOT NULL,
FOREIGN KEY(ID_CHANNEL) REFERENCES CHANNELS(ID_CHANNEL),
FOREIGN KEY(ID_USER) REFERENCES USERS(ID_USER),
PRIMARY KEY(ID_CHANNEL,ID_USER)
);

CREATE TABLE MESSAGES(
ID_MESSAGE INTEGER NOT NULL AUTO_INCREMENT,
TEXT VARCHAR(512) NOT NULL,
SEND_DATE DATE NOT NULL,
READ BOOLEAN NOT NULL,
ID_SENDER INTEGER NOT NULL,
ID_CHANNEL INTEGER NOT NULL,
TYPE ENUM("TEXT","IMAGE"),
PRIMARY KEY(ID_MESSAGE),
FOREIGN KEY(ID_SENDER) REFERENCES USERS(ID_USER),
FOREIGN KEY(ID_CHANNEL) REFERENCES CHANNELS(ID_CHANNEL),
);